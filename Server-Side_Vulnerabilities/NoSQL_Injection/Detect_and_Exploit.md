<h1>How The Heck Do I Detect NoSQL Injection? - FOR EDUCATIONAL PURPOSES ONLY</h1>

<h2>Attempt To Cause A Database Error</h2>
Try to cause a database error by injecting database specific strings that will cause errors.

```'"`{
;$Foo}
$Foo \xYZ```

URL Encoded: ```%27%22%60%7b%0d%0a%3b%24%46%6f%6f%7d%0d%0a%24%46%6f%6f%20%5c%78%59%5a```

JSON SAFE: ```'\"`{\r;$Foo}\n$Foo \\xYZ\u0000```

<h2>Determine Which Characters Break The Query</h2>

If the ' symbol breaks the query, try to escape it and see if the server still serves an error. If escaping the symbol fixes the backend query, the application is likely vulnerable to NoSQL Injection. Analyze
the images below to see this.

<mark>Injecting a ' symbol</mark>

<img width="1909" height="699" alt="detect-which-character-breaks-query" src="https://github.com/user-attachments/assets/a6ae4b0f-92b1-4065-8696-17261b864473" />

<mark>Escaping the ' symbol to fix the backend MongoDB query</mark>

<img width="1910" height="696" alt="fix-query-by-escaping-quote-symbol" src="https://github.com/user-attachments/assets/2307c91f-cdc7-42b7-a81c-1b54358c6561" />


<h2>Detecting NoSQL Syntax Injection - FOR EDUCATIONAL PURPOSES ONLY</h2>

Lets assume the backend MongoDB query is this.category=='' and the injection point is the 'category=' parameter

Injecting a single ' character make the backend MongoDB query into this.category==''' and will break the database query. Analyze the image below

<img width="1909" height="699" alt="detect-which-character-breaks-query" src="https://github.com/user-attachments/assets/e48fd37c-8187-495a-ac75-3c4e305318f2" />


Now that we know we can inject into the MongoDB query, let's inject a conditional at the end of the query to confirm all input is unsanitized.

Our payload will be: Lifestyle'+%26%26+this.category[0]=='L

This will make the MongoDB query look like: this.category=='Lifestyle' && this.category[0]=='L'

If this fixes the query and makes the server return data from the Lifestyle category, then the application is vulnerable.

Analyze the image below to see this

<img width="1911" height="695" alt="injecting-conditional-into-nosql-query" src="https://github.com/user-attachments/assets/0c1b95c3-9fbf-4f97-80e1-926326064550" />

<h3>Injecting A Conditional With A Null Character To Query Unauthorized Data</h3>

Because we can inject a conditional statement and ending the query with a null character, we can view data we are not authorized to view, like unreleased products in our case.
By ending the query in a null character, the MongoDB does not read the rest of the query where the developers attempted to only serve products that are released.

We simply inject: category=Lifestyle'+||+'1'=='1'%00 

which results in a backend query of: this.category=='Lifestyle' || '1'=='1'%00

Analyze the image below where we make the backend MongoDB serve us all products including unreleased products

<img width="1905" height="698" alt="conditional-with-null-character-to-show-unauthorized-data" src="https://github.com/user-attachments/assets/0078054c-672d-4979-8dca-35e31672e0d7" />







